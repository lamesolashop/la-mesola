<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shop Test - La Mesola</title>
    <style>
        body { font-family: sans-serif; padding: 20px; }
        .error { color: red; font-weight: bold; }
        .product-item { padding: 10px; border-bottom: 1px solid #ccc; }
    </style>
</head>
<body>
    <h1>Test Shop</h1>
    <div id="product-list" class="loading">
        <p>Caricamento dati...</p>
    </div>

    <script>
      // Incolla qui il tuo URL API funzionante
      const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzG04x2SecMI4Jh_2kH68f8DUXiX0RjWo39HDSsVCU8eZjc33jas1gUlH0ecsCtvAHL/exec';

      document.addEventListener("DOMContentLoaded", async () => {
        const container = document.getElementById("product-list");
        try {
          console.log("Fetching data from:", SCRIPT_URL);
          const response = await fetch(SCRIPT_URL);
          
          if (!response.ok) {
            throw new Error(`Errore di rete: ${response.status} ${response.statusText}`);
          }
          
          const data = await response.json();
          console.log("Data received:", data);

          if (data.error) {
            throw new Error(data.error);
          }

          if (!data.products || data.products.length === 0) {
            container.innerHTML = `<p>Nessun prodotto trovato nel JSON.</p>`;
            return;
          }

          // Se arriviamo qui, i dati sono stati ricevuti e sono validi
          container.innerHTML = ''; // Pulisce il messaggio "Caricamento..."
          
          data.products.forEach(product => {
            const productDiv = document.createElement('div');
            productDiv.className = 'product-item';
            // Visualizziamo SOLO il nome per questo test
            productDiv.textContent = product.name || 'Prodotto senza nome';
            container.appendChild(productDiv);
          });

        } catch (e) {
          console.error("ERRORE FATALE:", e);
          container.innerHTML = `<div class="error"><h1>ERRORE</h1><p>${e.message}</p></div>`;
        }
      });
    </script>
</body>
</html>
